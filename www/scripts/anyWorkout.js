
//--------------------------------------------------------------------------------------------------------------
//Workout will be generated by the local memory workout that was created by the user when they click the workout name 
//--------------------------------------------------------------------------------------------------------------


var localStore = JSON.parse(window.localStorage.getItem("Workouts"));
var workouts = localStore.exercises;
var maxSets = 0;
var exerciseCount = Math.floor(localStore.exercises.length / 4.0);

//Get Max Number of Sets
for (var i = 2; i < localStore.exercises.length; i += 4) {
	if (localStore.exercises[i] > maxSets)
		this.maxSets = localStore.exercises[i];
}
console.log(maxSets);

//generate table headers
var currentDiv = document.getElementById("any_workout_headers_1");
for (var j = 0; j < this.maxSets; j++) {
	var nodeTD = document.createElement("td")
	nodeTD.innerHTML = "Set " + (j + 1);
	nodeTD.className = "new_workout_data new_workout_headers";
	currentDiv.appendChild(nodeTD);
}

//Generate Workout names, weight, sets/Reps, empty sets space
for (var k = 0; k < exerciseCount; k++) {

	//get table reference
	var table = document.getElementById("any_workout_table")

	//Create Table Row to be added
	var tableRow = document.createElement("tr");
	tableRow.className = "new_workout_row";


	//create data to be added to row
	let tableDataName = document.createElement("td");
	tableDataName.className = "new_workout_data";
	tableDataName.innerHTML = workouts.shift();
	tableRow.appendChild(tableDataName);

	let tableDataWt = document.createElement("td");
	tableDataWt.className = "new_workout_data";
	tableDataWt.innerHTML = workouts.shift();
	tableRow.appendChild(tableDataWt);

	let tableDataSNR = document.createElement("td");
	tableDataSNR.className = "new_workout_data";
	tableDataSNR.innerHTML = "<sup>" + workouts.shift() + "</sup> / <sub>" + workouts.shift() + "</sub>";
	tableRow.appendChild(tableDataSNR);

	for (var l = 0; l < maxSets; l++) {
		let tableDataSet = document.createElement("td");
		tableDataSet.className = "new_workout_data";
		tableDataSet.innerHTML = "";
		tableDataSet.contentEditable = "true";
		tableRow.appendChild(tableDataSet);
	}
	table.appendChild(tableRow);
}



//--------------------------------------------------------------------------------------------------------------
//Start button will start timer and finish button will display elapsed time
//--------------------------------------------------------------------------------------------------------------
//initialize variables to be used across fucntions
var startTime = 0;
var endTime = 0;
var timeElapsed = 0;
var millisecondsElapsed
//start the timer on click
function startTimer() {
	startTime = new Date();
	console.log(startTime.toTimeString());
}

//end timer and find diff
function endTimer() {
	endTime = new Date();
	millisecondsElapsed = endTime - startTime;
	timeElapsed = Math.round((millisecondsElapsed / 1000) / 60)
	console.log("Minutes Elapsed: " + timeElapsed + ":" + Math.round(millisecondsElapsed / 1000 % 60));
}

//checks if the number is less than ten so we can add a zero before the numebr
function isLessThanTen() {
	if (Math.round(this.millisecondsElapsed / 1000 % 60) < 10)
		return 0;
	else return "";
}

//Displays the time in the appropriate spot; appends child node if doesnt exist
function displayWorkoutMinutes() {
	endTimer();
	let displayTimeLabel = document.createElement("h2");
	displayTimeLabel.innerHTML = "TIME ELAPSED";
	displayTimeLabel.style = "margin_top: 1.5rem;";
	displayTimeLabel.id = "displayTimeLabel";


	let displayTime = document.createElement("h2");
	displayTime.innerHTML = this.timeElapsed + ":" + isLessThanTen() + Math.round(this.millisecondsElapsed / 1000 % 60);
	displayTime.id = "display_time";

	if (document.getElementById("displayTimeLabel") != 'undefined' && document.getElementById("displayTimeLabel") != null) {
		document.getElementById("display_time").innerHTML = this.timeElapsed + ":" + isLessThanTen() + Math.round(this.millisecondsElapsed / 1000 % 60);
	} else {
		document.getElementById("end_timer").appendChild(displayTimeLabel);
		document.getElementById("end_timer").appendChild(displayTime);
	}

}